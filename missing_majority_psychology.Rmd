# Continent {data-navmenu="Psychology Journals"}

## Row 1 {data-height=600}

### Waffle plot of journal paper percentages, by continent (each square = 1% of data)

```{r continent_waffle_overall_psychology, fig.height = 4}
data_psych <- data %>% 
  filter(field == "psychology")

waffle_continent(data_psych, citation, citation_size = 7)

```

## Row 2 {data-height=600}

### Table of journal paper percentages, by continent {data-width=1000}

```{r, continent_table_psychology}
table_continent(data_psych)

```

```{r, results="asis"}
cat(instructions_table)
```

# Continent, by Year {data-navmenu="Psychology Journals"}

## Row 1 {data-height=700}

### Scatter plot of journal paper percentages, by continent and year {data-width=1460}

```{r, continent_scatter_overall_psychology}
scatter_continent_year(data_psych, 
                       method = "loess",
                       ymin = 0,
                       ymax = 100,
                       yby = 20,
                       citation = citation2)

```

### Figure Instructions Reminder

Hovering over a plotly figure opens up a menu on the top-right of the figure with various features:

1. Download Plot as a PNG
2. Zoom and Pan Buttons
3. Zoom In/Out
4. Autoscale and Reset Axes
5. Hover Options

#### Interacting With Data Points

1. When hovering over individual data points, you can see the raw data (year and percentage of papers).
2. When hovering over the regression line, you can see the predicted data (also for year and percentage of papers)
3. Click, hold, and drag to zoom into a specific window of the chart. Double-click anywhere to come back to the original zoom level.
4. Double-clicking on one continent or country on the chart on the right will isolate that regression line (and corresponding observations) for that category (e.g., if you double-click on North America, only the green line will remain). Double-click any category (e.g,. North America) again to add back all the other categories.
5. Similarly, a single click on one continent or country on the chart on the right will remove only that category. Click it again to bring it back. You can also remove several specific categories one at a time this way. Double-click any category (e.g,. North America) again to add back all the other categories.
6. When the legend is too long, make sure to use the scroll bar to see the rest of the legend.

## Row 2 {data-height=600}

### Table of journal paper percentages, by continent {data-width=1000}

```{r, continent_table_journal_year_psychology}
table_continent_year(data_psych)

```

```{r, results="asis"}
cat(instructions_table)
```

# Continent, by Journal {data-navmenu="Psychology Journals"}

## Row 1 {data-height=1000}

### Waffle plot of journal paper percentages, by continent and journal (each square = 1% of data) {data-height=680}

```{r continent_table_journal_figure_psychology}
waffle_continent_journal(data_psych, citation)

dictio <- journal_field %>% 
    filter(field == "psychology") %>% 
    mutate(dictio = paste0(journal_abbr, ": ", journal)) %>% 
    pull(dictio) %>% 
    toString()

```

> *Note*. `r dictio`

## Row 2 {data-height=680}

### Table of journal paper percentages, by continent and journal {data-width=1000}

```{r continent_table_journal_psychology}
table_continent_journal(data_psych)

```

```{r, results="asis"}
cat(instructions_table)
```

# Country {data-navmenu="Psychology Journals"}

## Row 1 {data-height=700}

### Waffle plot of journal paper percentages, by country (each flag = 1% of data)

```{r country_table_overall_psychology, fig.width=4.5, fig.height=4.5}
waffle_country(data_psych, citation, citation_size = 7)

```

## Row 2 {data-height=650}

### Table of journal paper percentages, by country {data-width=1000}

```{r country_table_journal_psychology}
table_country(data_psych)

```

```{r, results="asis"}
cat(instructions_table)
```

# Country, by Year {data-navmenu="Psychology Journals"}

## Row 1 {data-height=700}

### Scatter plot of journal paper percentages, by country and year {data-width=1460}

```{r, country_series_year_psychology}
scatter_country_year(data_psych, 
                     method = "lm",
                     ymin = 0,
                     ymax = 100,
                     yby = 20,
                     citation = citation2)

# Include flags on scatter plot
# Note: doesn't work with ggplotly it seems
# library(ggflags)
# df.country.year %>%
#   mutate(year = as.numeric(year),
#          country = countrycode(country, "country.name", "genc2c"),
#          country = tolower(country),
#          country = as.factor(country)) %>%
#   nice_scatter(
#              predictor = "year",
#              response = "percentage",
#              group = "country",
#              colours = colors,
#              method = "lm",
#              groups.order = "decreasing",
#              ytitle = "% of All Papers") + 
#   geom_flag(aes(country = country)) +#%>%
#   scale_country(aes(country = country)) #%>%
  #ggplotly(tooltip = c("x", "y"))

# Time series dygraph 
# dygraph_year(data_psych)
# dygraph_year(data_psych, "country")

```

### Figure Instructions Reminder

Hovering over a plotly figure opens up a menu on the top-right of the figure with various features:

1. Download Plot as a PNG
2. Zoom and Pan Buttons
3. Zoom In/Out
4. Autoscale and Reset Axes
5. Hover Options

#### Interacting With Data Points

1. When hovering over individual data points, you can see the raw data (year and percentage of papers).
2. When hovering over the regression line, you can see the predicted data (also for year and percentage of papers)
3. Click, hold, and drag to zoom into a specific window of the chart. Double-click anywhere to come back to the original zoom level.
4. Double-clicking on one continent or country on the chart on the right will isolate that regression line (and corresponding observations) for that category (e.g., if you double-click on North America, only the green line will remain). Double-click any category (e.g,. North America) again to add back all the other categories.
5. Similarly, a single click on one continent or country on the chart on the right will remove only that category. Click it again to bring it back. You can also remove several specific categories one at a time this way. Double-click any category (e.g,. North America) again to add back all the other categories.
6. When the legend is too long, make sure to use the scroll bar to see the rest of the legend.

## Row 2 {data-height=650}

### Table of journal paper percentages, by country and year {data-width=1000}

```{r, country_table_year_psychology}
table_country_year(data_psych)

```

```{r, results="asis"}
cat(instructions_table)
```

# Country, by Journal {data-navmenu="Psychology Journals"}

## Row 1 {data-height=700}

### Waffle plot of journal paper percentages, by continent and journal (each square = 1% of data) {data-height=680}

```{r country_table_journal_figure_psychology}
waffle_country_journal(data_psych, citation)

```

> *Note*. `r dictio`

## Row 2 {data-height=680}

### Table of journal paper percentages, by country and journal {data-width=1000}

```{r country_table_journal2_psychology}
table_country_journal(data_psych)

```

```{r, results="asis"}
cat(instructions_table)
```
